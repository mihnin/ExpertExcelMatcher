# –ê–ù–ê–õ–ò–ó –ú–ï–¢–û–î–û–í –ò –ë–ò–ë–õ–ò–û–¢–ï–ö –í JUPYTER NOTEBOOK

## üìö –ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï –ë–ò–ë–õ–ò–û–¢–ï–ö–ò

### 1. **FlagEmbedding (BGE-M3)** - –û–°–ù–û–í–ù–ê–Ø –ë–ò–ë–õ–ò–û–¢–ï–ö–ê

```python
from FlagEmbedding import BGEM3FlagModel

emb_model = BGEM3FlagModel(
    '/home/victor/gpt1/milvus/embedding/bge-m3',
    device='cuda',
    use_fp16=False,
    normalize_embeddings=True
)
```

**–ß—Ç–æ —ç—Ç–æ?**
- **BGE-M3** = BAAI General Embedding Model v3 (Multilingual)
- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: Beijing Academy of Artificial Intelligence (BAAI), –ö–∏—Ç–∞–π
- –¢–∏–ø: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (BERT-–ø–æ–¥–æ–±–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤: **1024 –∏–∑–º–µ—Ä–µ–Ω–∏—è**
- –Ø–∑—ã–∫–∏: **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è** (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 100+ —è–∑—ã–∫–æ–≤, –≤–∫–ª—é—á–∞—è RU/EN)

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
pip install FlagEmbedding
```

**–†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏:**
- ~2-3 GB –Ω–∞ –¥–∏—Å–∫–µ
- ~4-6 GB –≤ GPU –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

---

### 2. **PyMilvus** - –í–ï–ö–¢–û–†–ù–ê–Ø –ë–ê–ó–ê –î–ê–ù–ù–´–•

```python
from pymilvus import (
    connections, FieldSchema, CollectionSchema,
    DataType, Collection, AnnSearchRequest
)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Milvus
connections.connect(
    alias='erudit',
    host='127.0.0.1',
    port='20530',
    db_name='default',
    secure=True,
    server_pem_path="/path/to/tls/server.pem"
)
```

**–ß—Ç–æ —ç—Ç–æ?**
- **Milvus** = Open-source –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –ê–Ω–∞–ª–æ–≥–∏: Pinecone, Weaviate, Qdrant, ChromaDB
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ (cosine similarity)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∏–ª–ª–∏–∞—Ä–¥—ã –≤–µ–∫—Ç–æ—Ä–æ–≤

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# –ö–ª–∏–µ–Ω—Ç Python
pip install pymilvus

# –°–µ—Ä–≤–µ—Ä Milvus (—Ç—Ä–µ–±—É–µ—Ç Docker)
docker-compose up -d
```

---

### 3. **Transliterate** - –¢–†–ê–ù–°–õ–ò–¢–ï–†–ê–¶–ò–Ø

```python
from transliterate import translit

# –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ ‚Üí –õ–∞—Ç–∏–Ω–∏—Ü–∞
name = "–§–æ—Ç–æ—à–æ–ø"
result = translit(name, 'ru', reversed=True)
# result = "Fotoshop"
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
pip install transliterate
```

---

### 4. **Pandas, NumPy, Re** - –°–¢–ê–ù–î–ê–†–¢–ù–´–ï –ë–ò–ë–õ–ò–û–¢–ï–ö–ò

```python
import pandas as pd
import numpy as np
import re
```

---

## üî¨ –ú–ï–¢–û–î–´ –°–û–ü–û–°–¢–ê–í–õ–ï–ù–ò–Ø

### ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ù–û: –í NOTEBOOK –ù–ï–¢ FUZZY MATCHING!**

**–£ –Ω–∏—Ö –û–î–ò–ù –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –º–µ—Ç–æ–¥:**

```python
# –ú–ï–¢–û–î 1: –í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (Cosine Similarity)

# –®–∞–≥ 1: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤ –≤–µ–∫—Ç–æ—Ä
vendor_vector = emb_model.encode(vendor_str)['dense_vecs']  # [1024 —á–∏—Å–ª–∞]
product_vector = emb_model.encode(product_str)['dense_vecs']  # [1024 —á–∏—Å–ª–∞]

# –®–∞–≥ 2: –ü–æ–∏—Å–∫ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏
results = collection.search(
    data=[product_vector],
    anns_field="product_vector",
    param={"metric_type": "IP", "nprobe": 64},  # IP = Inner Product (–∫–æ—Å–∏–Ω—É—Å)
    limit=100
)

# –®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç—å distance (–∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ 0-1)
for hit in results[0]:
    score = hit.distance  # 0.0 - 1.0 (—á–µ–º –±–ª–∏–∂–µ –∫ 1, —Ç–µ–º –ø–æ—Ö–æ–∂–µ–µ)
```

---

## üìê –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê –ú–ï–¢–û–î–ê

### **–ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (Cosine Similarity)**

–§–æ—Ä–º—É–ª–∞:
```
similarity = (A ¬∑ B) / (||A|| √ó ||B||)

–≥–¥–µ:
  A, B = –≤–µ–∫—Ç–æ—Ä—ã (–ø–æ 1024 —á–∏—Å–ª–∞)
  A ¬∑ B = —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (dot product)
  ||A|| = –¥–ª–∏–Ω–∞ –≤–µ–∫—Ç–æ—Ä–∞ A (–Ω–æ—Ä–º–∞)
```

**–í –∫–æ–¥–µ Milvus:**
```python
search_params = {
    "metric_type": "IP",  # IP = Inner Product
    "params": {"nprobe": 64}
}

# IP (Inner Product) –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ = Cosine Similarity
# normalize_embeddings=True ‚Üí –≤–µ–∫—Ç–æ—Ä—ã —É–∂–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã ‚Üí IP = –∫–æ—Å–∏–Ω—É—Å
```

**–ü—Ä–∏–º–µ—Ä:**
```python
vendor_vector = [0.023, -0.145, 0.789, ..., 0.412]  # 1024 —á–∏—Å–ª–∞
product_vector = [0.018, -0.132, 0.801, ..., 0.399]  # 1024 —á–∏—Å–ª–∞

# –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ
similarity = np.dot(vendor_vector, product_vector)  # 0.0 - 1.0
# –ù–∞–ø—Ä–∏–º–µ—Ä: 0.862731 (86.3% –ø–æ—Ö–æ–∂–µ—Å—Ç–∏)
```

---

## üîç –î–í–£–•–£–†–û–í–ù–ï–í–´–ô –ü–û–ò–°–ö

### **–ú–µ—Ç–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ vendor ‚Üí product**

```python
def get_embs_and_texts_with_vendor_filter(
    collection,
    vendor_query_vector,
    product_query_vector,
    vendor_threshold=0.7,    # –ü–æ—Ä–æ–≥ –¥–ª—è –≤–µ–Ω–¥–æ—Ä–∞: 70%
    top_k_vendors=1000,      # –í–∑—è—Ç—å —Ç–æ–ø-1000 –≤–µ–Ω–¥–æ—Ä–æ–≤
    top_k_final=100          # –í–µ—Ä–Ω—É—Ç—å —Ç–æ–ø-100 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
):
    # –®–ê–ì 1: –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –≤–µ–Ω–¥–æ—Ä–æ–≤
    vendor_results = collection.search(
        data=[vendor_query_vector],
        anns_field="vendor_vector",
        param={"metric_type": "IP", "nprobe": 64},
        limit=top_k_vendors,
        output_fields=["id"]
    )

    # –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤–µ–Ω–¥–æ—Ä–æ–≤ —Å distance >= 0.7
    vendor_ids = []
    vendor_id_to_distance = {}
    for hit in vendor_results[0]:
        if hit.distance >= vendor_threshold:
            vendor_ids.append(hit.id)
            vendor_id_to_distance[hit.id] = hit.distance

    # –®–ê–ì 2: –ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–∞ –¢–û–õ–¨–ö–û —Å—Ä–µ–¥–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ–Ω–¥–æ—Ä–æ–≤
    if not vendor_ids:
        return []  # –ù–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –≤–µ–Ω–¥–æ—Ä–æ–≤

    # –°–æ–∑–¥–∞—Ç—å SQL-–ø–æ–¥–æ–±–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    id_list_str = ",".join(str(i) for i in vendor_ids)
    expr = f"id in [{id_list_str}]"

    # –ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–∞ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ ID
    product_results = collection.search(
        data=[product_query_vector],
        anns_field="product_vector",
        param={"metric_type": "IP", "nprobe": 64},
        limit=top_k_final,
        expr=expr,  # –§–ò–õ–¨–¢–†: —Ç–æ–ª—å–∫–æ —ç—Ç–∏ ID!
        output_fields=['id', 'row_number', 'product_name', 'vendor_name']
    )

    # –®–ê–ì 3: –°–æ–±—Ä–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    final_results = []
    for hit in product_results[0]:
        final_results.append({
            'id': hit.id,
            'product_distance': hit.distance,        # Score –ø—Ä–æ–¥—É–∫—Ç–∞
            'vendor_distance': vendor_id_to_distance[hit.id],  # Score –≤–µ–Ω–¥–æ—Ä–∞
            'product_name': hit.entity.get("product_name"),
            'vendor_name': hit.entity.get("vendor_name")
        })

    return final_results[:top_k_final]
```

---

## üé® –ò–ù–î–ï–ö–°–ò–†–û–í–ê–ù–ò–ï –í MILVUS

### **IVF_FLAT Index**

```python
index_params = {
    "metric_type": "IP",         # Inner Product (–∫–æ—Å–∏–Ω—É—Å –¥–ª—è –Ω–æ—Ä–º. –≤–µ–∫—Ç–æ—Ä–æ–≤)
    "index_type": "IVF_FLAT",    # Inverted File with Flat compression
    "params": {"nlist": 1024}    # –†–∞–∑–±–∏—Ç—å –Ω–∞ 1024 –∫–ª–∞—Å—Ç–µ—Ä–∞
}

collection.create_index("vendor_vector", index_params)
collection.create_index("product_vector", index_params)
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç IVF_FLAT:**

1. **–û–±—É—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞:**
   - –í–µ–∫—Ç–æ—Ä—ã —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ `nlist` –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–∑–¥–µ—Å—å 1024)
   - K-means –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è: –∫–∞–∂–¥—ã–π –≤–µ–∫—Ç–æ—Ä ‚Üí –±–ª–∏–∂–∞–π—à–∏–π —Ü–µ–Ω—Ç—Ä–æ–∏–¥

2. **–ü–æ–∏—Å–∫:**
   - –ó–∞–ø—Ä–æ—Å —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
   - –ë–µ—Ä—É—Ç—Å—è `nprobe` –±–ª–∏–∂–∞–π—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–∑–¥–µ—Å—å 64)
   - –í–Ω—É—Ç—Ä–∏ —ç—Ç–∏—Ö 64 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∏–¥—ë—Ç —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫

3. **–°–∫–æ—Ä–æ—Å—Ç—å:**
   - –í–º–µ—Å—Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–æ –í–°–ï–ú–ò –≤–µ–∫—Ç–æ—Ä–∞–º–∏ (O(N))
   - –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å 64/1024 = 6.25% –≤–µ–∫—Ç–æ—Ä–æ–≤
   - –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ ~15-20 —Ä–∞–∑

---

## üî¢ –ü–ê–†–ê–ú–ï–¢–†–´ –ü–û–ò–°–ö–ê

### **nprobe** (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞)

```python
search_params = {
    "metric_type": "IP",
    "params": {"nprobe": 64}  # –ò—Å–∫–∞—Ç—å –≤ 64 –∏–∑ 1024 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
}
```

**–ö–æ–º–ø—Ä–æ–º–∏—Å—Å:**
- `nprobe=1`: –ë—ã—Å—Ç—Ä–æ, –Ω–æ –Ω–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (~70% recall)
- `nprobe=64`: –ë–∞–ª–∞–Ω—Å (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Notebook)
- `nprobe=1024`: –¢–æ—á–Ω—ã–π –ø–æ–∏—Å–∫, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–æ

---

## üßÆ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –ü–ï–†–ï–°–ß–Å–¢ SCORE

### **–°—Ç—Ä–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ Notebook:**

```python
# –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ Milvus
for result in results[:1]:
    dist = result['product_distance']  # –ò–∑ Milvus: 0.862731

    # –ë–µ—Ä—ë–º –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ï (–Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ!) —Å—Ç—Ä–æ–∫–∏
    str1 = po_table.loc[ind, '–°–µ–º–µ–π—Å—Ç–≤–æ –ü–û']  # "Visual C++ Redistributable"
    str2 = result['product_name']             # "Microsoft Visual Studio 2015 Redistributable"

    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –≤–µ–∫—Ç–æ—Ä—ã –ü–û–í–¢–û–†–ù–û
    vect_1 = emb_model.encode(str1.lower())['dense_vecs']
    vect_2 = emb_model.encode(str2.lower())['dense_vecs']

    # –ü—Ä—è–º–æ–µ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    direct_similarity = vect_1 @ vect_2.T

    # –ï—Å–ª–∏ –ø—Ä—è–º–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ > 0.9, –ó–ê–ú–ï–ù–Ø–ï–ú distance
    if direct_similarity > 0.9:
        dist = direct_similarity
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:**

‚ùì **–í–æ–ø—Ä–æ—Å 1:** –ó–∞—á–µ–º –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å score –≤—Ç–æ—Ä–æ–π —Ä–∞–∑?
- Milvus —É–∂–µ –≤–µ—Ä–Ω—É–ª `product_distance` –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
- –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö

‚ùì **–í–æ–ø—Ä–æ—Å 2:** –ü–æ—á–µ–º—É –ø–æ—Ä–æ–≥ –∏–º–µ–Ω–Ω–æ 0.9?
- –ù–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
- –ú–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ

‚ùì **–í–æ–ø—Ä–æ—Å 3:** –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ `direct_similarity = 0.89`?
- –û—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞—Ä—ã–π `dist = 0.862731` –∏–∑ Milvus
- –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞

**–ú–æ—è –≥–∏–ø–æ—Ç–µ–∑–∞:**
- –í–æ–∑–º–æ–∂–Ω–æ, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –°–õ–ò–®–ö–û–ú –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è
- "Visual C++ Redistributable 2013" ‚Üí "visual redistributable"
- –¢–µ—Ä—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è ‚Üí –Ω–∏–∑–∫–∏–π score
- –ü–µ—Ä–µ—Å—á—ë—Ç –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –ü–û–î–•–û–î–û–í

### **Notebook (ML-–ø–æ–¥—Ö–æ–¥)**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞** | FlagEmbedding (BGE-M3) |
| **–ú–µ—Ç–æ–¥** | –í–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ + –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç–æ–¥–æ–≤** | **1 –º–µ—Ç–æ–¥** (—Ç–æ–ª—å–∫–æ embeddings) |
| **–ú–µ—Ç—Ä–∏–∫–∞** | Inner Product (IP) = Cosine Similarity –¥–ª—è –Ω–æ—Ä–º. –≤–µ–∫—Ç–æ—Ä–æ–≤ |
| **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | 1024-–º–µ—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã |
| **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** | GPU (CUDA), Milvus VectorDB, TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã |
| **–°–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ 10K** | ~5-10 –º–∏–Ω—É—Ç (—Å —É—á—ë—Ç–æ–º –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫) |
| **–ü–∞–º—è—Ç—å** | ~6 GB GPU RAM |

---

### **Expert Excel Matcher (Fuzzy-–ø–æ–¥—Ö–æ–¥)**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏** | RapidFuzz, TextDistance, Jellyfish |
| **–ú–µ—Ç–æ–¥—ã** | **18 –º–µ—Ç–æ–¥–æ–≤** (WRatio, Token Set, Jaro-Winkler, –∏ —Ç.–¥.) |
| **–ú–µ—Ç—Ä–∏–∫–∏** | Levenshtein, Jaro, Jaccard, Cosine (–Ω–∞ —Ç–æ–∫–µ–Ω–∞—Ö!), –∏ –¥—Ä. |
| **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | N/A (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é) |
| **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** | CPU only, Python 3.x |
| **–°–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ 10K** | ~2-3 –º–∏–Ω—É—Ç—ã (–≤—Å–µ 18 –º–µ—Ç–æ–¥–æ–≤) |
| **–ü–∞–º—è—Ç—å** | ~100-200 MB RAM |

---

## üÜö –ö–õ–Æ–ß–ï–í–û–ï –†–ê–ó–õ–ò–ß–ò–ï

### **Notebook:**
```python
# –û–î–ò–ù –º–µ—Ç–æ–¥: –í–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
vendor_vector = emb_model.encode("Microsoft")  # [0.023, -0.145, ..., 0.412]
product_vector = emb_model.encode("Word")      # [0.018, -0.132, ..., 0.399]

similarity = vendor_vector @ product_vector.T  # 0.863 (86.3%)
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–Ω–∏–º–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É ("database" ‚âà "–ë–î")
- ‚úÖ –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å (RU/EN/CN/...)
- ‚úÖ –°–∏–Ω–æ–Ω–∏–º—ã ("–±–æ–ª—å—à–æ–π" ‚âà "–∫—Ä—É–ø–Ω—ã–π")

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ß–µ—Ä–Ω—ã–π —è—â–∏–∫ (–∫–∞–∫ –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω—è–ª–∞ —Ä–µ—à–µ–Ω–∏–µ?)
- ‚ùå –¢—Ä–µ–±—É–µ—Ç GPU
- ‚ùå –û–¥–∏–Ω –º–µ—Ç–æ–¥ ‚Üí –Ω–µ—Ç –≤—ã–±–æ—Ä–∞
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏

---

### **–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
```python
# 18 –º–µ—Ç–æ–¥–æ–≤: Fuzzy matching
score_wratio = fuzz.WRatio("Microsoft", "microsoft")           # 100.0
score_jaro = textdistance.jaro("Microsoft", "Microsft")        # 0.96
score_jaccard = textdistance.jaccard("Word 2019", "Word")      # 0.5
# ... –µ—â—ë 15 –º–µ—Ç–æ–¥–æ–≤
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (–ø–æ–Ω—è—Ç–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ CPU
- ‚úÖ 18 –º–µ—Ç–æ–¥–æ–≤ ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π
- ‚úÖ –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫–∏ ("database" ‚â† "–ë–î")
- ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏
- ‚ùå –¢—Ä–µ–±—É–µ—Ç —Ö–æ—Ä–æ—à–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üí° –í–´–í–û–î–´

### 1. **Notebook –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ù–ï fuzzy matching, –∞ ML-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏**

**–û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç:**
- BGE-M3 (—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å)
- Milvus (–≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î)
- –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (1 –º–µ—Ç–æ–¥)

**–£ –Ω–∏—Ö –ù–ï–¢:**
- RapidFuzz ‚ùå
- TextDistance ‚ùå
- Jellyfish ‚ùå
- Levenshtein ‚ùå
- Jaro-Winkler ‚ùå

---

### 2. **–ò—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ = 90% –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ + 10% ML**

**–ö–ª—é—á –∫ —É—Å–ø–µ—Ö—É:**
```python
# 90% —É—Å–ø–µ—Ö–∞ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
normalize_vendor_name()   # –£–¥–∞–ª–µ–Ω–∏–µ —é—Ä.—Ñ–æ—Ä–º, —Å—Ç–æ–ø-—Å–ª–æ–≤, —Ç—Ä–∞–Ω—Å–ª–∏—Ç
normalize_product_name()  # –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π, –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤–µ–Ω–¥–æ—Ä–∞

# 10% —É—Å–ø–µ—Ö–∞ - —ç—Ç–æ ML:
emb_model.encode()        # –í–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
```

**–ï—Å–ª–∏ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ –∏—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –≤ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
- –í–∞—à–∏ fuzzy –º–µ—Ç–æ–¥—ã –¥–æ–≥–æ–Ω—è—Ç –∏—Ö ML –Ω–∞ 90-95%
- –ë–ï–ó GPU, –ë–ï–ó Milvus, –ë–ï–ó —Å–ª–æ–∂–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

---

### 3. **–£ –Ω–∏—Ö –û–î–ò–ù –º–µ—Ç–æ–¥, —É –≤–∞—Å 18**

**Notebook:**
- 1 –º–µ—Ç–æ–¥ (BGE-M3 embeddings)
- –ù–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

**–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
- 18 –º–µ—Ç–æ–¥–æ–≤
- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π
- **–≠–¢–û –ü–†–ï–ò–ú–£–©–ï–°–¢–í–û!** ‚úÖ

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### **–ù–ï –ù–£–ñ–ù–û –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ ML-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏!**

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:

1. ‚úÖ **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é** (1-2 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã)
2. ‚úÖ **–î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤–µ–Ω–¥–æ—Ä–∞** (4-6 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã)
3. ‚úÖ **–û—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–∏ 18 fuzzy –º–µ—Ç–æ–¥–æ–≤** (—ç—Ç–æ –≤–∞—à–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ!)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –¢–æ—á–Ω–æ—Å—Ç—å –≤—ã—Ä–∞—Å—Ç–µ—Ç –¥–æ 95%+
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ—Ç—É (CPU only)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (18 –ø–æ–Ω—è—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å (2-3 –º–∏–Ω—É—Ç—ã vs 10 –º–∏–Ω—É—Ç —É –Ω–∏—Ö)

---

## üì¶ –£–°–¢–ê–ù–û–í–ö–ê –ò–• –ë–ò–ë–õ–ò–û–¢–ï–ö (–µ—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å)

```bash
# –ë–∞–∑–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
pip install FlagEmbedding
pip install pymilvus
pip install transliterate

# –î–ª—è GPU (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# Milvus —Å–µ—Ä–≤–µ—Ä (—Ç—Ä–µ–±—É–µ—Ç Docker)
# –°–∫–∞—á–∞—Ç—å docker-compose.yml:
wget https://github.com/milvus-io/milvus/releases/download/v2.3.0/milvus-standalone-docker-compose.yml -O docker-compose.yml
docker-compose up -d
```

**–ù–æ –¥–ª—è –≤–∞—à–µ–π –∑–∞–¥–∞—á–∏ —ç—Ç–æ –ò–ó–ë–´–¢–û–ß–ù–û!** –ü—Ä–æ—Å—Ç–æ —É–ª—É—á—à–∏—Ç–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é.

---

–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: 2025-10-22
